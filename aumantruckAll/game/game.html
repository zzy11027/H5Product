<html>
 
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>拯救新鲜大作战</title>
		<link rel="stylesheet" href="templates/game/css/css.css">
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>

    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5f8bdc12f044fa2a42675bfbbfa0d7c6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</head>
<body>
	<input type="hidden" id="openid" value="{$openid}">
	<input type="hidden" id="nickname" value="{$nickname}">
	<input type="hidden" id="num" value="{$num}">
	<!-- 首页 -->
	<div class="kai">

		<div class="gui_1"></div>

		<div class="gui">

			<div class="close">

			</div>

		</div>

		<div class="start"></div>
	
	</div>




	<!-- 游戏页 -->
	<div class="gif">

		<div class="gif_1">

		</div>
	</div>
	<div class="content">

		<!-- 积分 -->
		<div class="ling">0</div>

		<!-- 倒计时 -->
		<div class="time">30</div>



		<!-- 物品 -->
				<!-- <img id="div1" src="templates/game/img/save.svg"> -->
			<div class="wu">
					
				<img src="templates/game/img/bl.png" alt="" id="div1">
				<img src="templates/game/img/hlb.png" alt="" id="div2">
				<img src="templates/game/img/lz.png" alt="" id="div3">
				<img src="templates/game/img/mg.png" alt="" id="div4">
				<img src="templates/game/img/pt.png" alt="" id="div5">
				<!-- <img src="templates/game/img/qyg.png" alt="" id="div6">
				<img src="templates/game/img/sb.png" alt="" id="div7">
				<img src="templates/game/img/xhs.png" alt="" id="div8">
				<img src="templates/game/img/xia.png" alt="" id="div9">
				<img src="templates/game/img/xing.png" alt="" id="div10"> -->
				<img src="templates/game/img/xlh.png" alt="" id="div11">
				<img src="templates/game/img/yao.png" alt="" id="div12">
				<img src="templates/game/img/yds.png" alt="" id="div13">
				<img src="templates/game/img/yu.png" alt="" id="div14">
				<img src="templates/game/img/zhen.png" alt="" id="div15">
		

			</div>

			
			<!-- 分类 -->

			<div class="div_1"></div>
			<div class="div_2"></div>
			<div class="div_3"></div>
			<div class="div_4"></div>		


			<!-- 提示错误 -->
			<div id="errormsg_1">

			</div>

	</div>



	<!--挑战成功  -->
	<div class="over">

		<div class="all">

			<div class="jf"></div>

			<div class="ph"></div>


			<input type="text" class="inp_1" placeholder="" value="请输入您的姓名" id="names" onfocus="if(value=='请输入您的姓名') {value=''}" onblur="if (value=='') {value='请输入您的姓名'}">


			<input type="text" class="inp_2" placeholder="" value="请输入您的电话" id="phone" onfocus="if(value=='请输入您的电话') {value=''}" onblur="if (value=='') {value='请输入您的电话'}">
		

			<div class="chou"></div>

			<div class="fen"></div>


		</div>
	
		<div class="fenx">


		</div>
	</div>

	<!-- 挑战失败 -->
	<div class="no">

		<div class="jf-1"></div>
		<a href="http://www.aumantruck.com/mobile/spike_game.php?" class="no_1"></a>
	</div>
	
	<!-- 奖品 -->
	<div class="price">

		<p class="p_1"></p>
		<!-- <p class="p_2"></p> -->

		<div class="tj" onclick="tj()">


		</div>

	</div>

	<div class="lost">

		<a href="http://www.aumantruck.com/mobile/spike_game.php?" class="no_1"></a>
	</div>


<!-- 背景音频 -->
		<audio src="templates/game/img/1.mp3" id="music" preload="preload" class="audio" autoplay="autoplay"  loop="loop" preload="auto" >
			你的浏览器不支持video元素
		</audio>
<!-- 错误提示音乐 -->

		<audio src="templates/game/img/2.mp3" id="musics_1" preload="preload" class="audio_1">
			你的浏览器不支持video元素
		</audio>

<!--正确提示音乐 -->

		<audio src="templates/game/img/3.mp3" id="musics" preload="preload" class="audio_2">
			你的浏览器不支持video元素
		</audio>

		<div id="but" class="but" onclick="Play(this)"></div>

	<script src="templates/game/js/jquery.min.js"></script>
	<script src="templates/game/js/1.js"></script>
	<script src="templates/game/js/check.js"></script>
	<script>
    var num = $("#num").val();
    if (num) {

    	wx.config({
            debug: false, // 开启调试模式调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印�?
            appId: 'wxa1ef57725e6a43a9', // 必填，公众号的唯一标识
            timestamp: '{$arr.timestamp}', // 必填，生成签名的时间
            nonceStr: '{$arr.noncestr}', // 必填，生成签名的随机
            signature: '{$arr.sha1}',// 必填，签名，见附
            jsApiList: [
                "onMenuShareTimeline",
                "scanQRCode",
                "onMenuShareAppMessage",
                "onMenuShareQQ",
                "onMenuShareWeibo",
                "onMenuShareQZone"
            ] // 必填，需要使用的JS接口列表，所有JS接口列表见附
        });
        wx.ready(function () {
           wx.onMenuShareAppMessage({
                title: '欧曼EST冷链之星，与你一起拯救新鲜！', // 分享标题
                desc: '{$nickname}以{$num}分的成绩傲视群雄，你敢来挑战Ta赢取丰厚奖品吗？', // 分享描述
                link: 'http://www.aumantruck.com/mobile/spike_game.php?', // 分享链接
                imgUrl: 'http://www.aumantruck.com/mobile/templates/game/img/logo.jpg', // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    //alert("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    //alert("取消成功");
                    // 用户取消分享后执行的回调函数
                }

            });
            wx.onMenuShareTimeline({
                title: '欧曼EST冷链之星，与你一起拯救新鲜', // 分享标题
                link: 'http://www.aumantruck.com/mobile/spike_game.php?', // 分享链接
                imgUrl: 'http://www.aumantruck.com/mobile/templates/game/img/logo.jpg', // 分享图标
                success: function () {
                  //  alert("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                  //  alert("取消成功");
                    // 用户取消分享后执行的回调函数
                }
            });
        })
    }else{

    	wx.config({
            debug: false, // 开启调试模式调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印�?
            appId: 'wxa1ef57725e6a43a9', // 必填，公众号的唯一标识
            timestamp: '{$arr.timestamp}', // 必填，生成签名的时间
            nonceStr: '{$arr.noncestr}', // 必填，生成签名的随机
            signature: '{$arr.sha1}',// 必填，签名，见附
            jsApiList: [
                "onMenuShareTimeline",
                "scanQRCode",
                "onMenuShareAppMessage",
                "onMenuShareQQ",
                "onMenuShareWeibo",
                "onMenuShareQZone"
            ] // 必填，需要使用的JS接口列表，所有JS接口列表见附
        });
        wx.ready(function () {
            wx.onMenuShareAppMessage({
                title: '欧曼EST冷链之星，与你一起拯救新鲜', // 分享标题
                desc: '拯救新鲜蔬果就能参与抽奖，赶快来参与挑战看看你的人品如何？', // 分享描述
                link: 'http://www.aumantruck.com/mobile/spike_game.php?', // 分享链接
                imgUrl: 'http://www.aumantruck.com/mobile/templates/game/img/logo.jpg', // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    //alert("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    //alert("取消成功");
                    // 用户取消分享后执行的回调函数
                }

            });
            wx.onMenuShareTimeline({
                title: '欧曼EST冷链之星，与你一起拯救新鲜', // 分享标题
                link: 'http://www.aumantruck.com/mobile/spike_game.php?', // 分享链接
                imgUrl: 'http://www.aumantruck.com/mobile/templates/game/img/logo.jpg', // 分享图标
                success: function () {
                  //  alert("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                  //  alert("取消成功");
                    // 用户取消分享后执行的回调函数
                }
            });
        })
    }
    </script>
    
	<script type="text/javascript">
		var w = 375;
		var f = 16;
		var c = document.documentElement.clientWidth;
		var nf = c * f / w;
		document.documentElement.style.fontSize = nf + 'px';


		// 首页规则
		$('.gui_1').click(function(){

			$('.gui').fadeIn(300);
		})

		$('.close').click(function(){
			$('.gui').fadeOut(300);
		})

		// 开始游戏
		$('.start').click(function(){
			$('.kai').fadeOut(300);

			// start();

			$('.gif').show();

			$('.content').show();
		})


		// 点击gif开始游戏
		$('.gif').click(function(){
			$('.gif').hide();
			start();
		})
		$('.gif_1').click(function(){
			$('.gif').hide();
			// start();
		})


		// 分享
		$('.fen').click(function(){
			$('.fenx').show();
			$('.all').hide();
		})

		$('.fenx').click(function(){
			$('.fenx').hide();
			$('.all').show();
		})
		$('.chou').click(function(){
			var openid = $("#openid").val();
			var types = $('.ph').text();
			var fen = $('.ling').text();

			$names = $("#names").val();
			$openid = $("#openid").val();
			$phone = $("#phone").val();
			if ($names=="请输入您的姓名") {
				alert('请输入您的姓名');
	            return false;
			}
			if ($names=="") {
				alert('请输入您的姓名');
	            return false;
			}
			if ($phone=="") {
				alert('请输入您的电话');
	            return false;
			}
			if ($phone=="请输入您的电话") {
				alert('请输入您的电话');
	            return false;
			}

			var reg = /^0?1[3|4|5|7|8][0-9]\d{8}$/;
	        if (!reg.test($phone)) {
	            alert("请输入正确的手机号");
	            return false;
	        }
			$.ajax({

	            type: "POST",
	            url: "spike_game.php?step=prize",
	            data:{
	            	openid:openid,
	            	types:types,
	            	fen:fen,
	            	names:$names,
	            	phone:$phone
				},
	            success: function (res) {
	            	$('.over').hide();
	            	$('.price').show();
	            	if (res == 1) {
	            		// 车载冰箱
	            		var pri_1 = '车载冰箱一台';
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}
	            	if (res == 2) {
	            		// 腾讯会员/爱奇艺/优酷
	            		var random = Math.floor(Math.random()*(3-1+1)+1);
	            		if(random == 1){
	            			var pri_1 = '爱奇艺会员(3个月)';
	            		}else if(random == 2){
	            			var pri_1 = '优酷会员(3个月)';
	            		}else if(random == 3){
	            			var pri_1 = '腾讯会员(3个月)';
	            		}
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}

	            	if(res == 3){
	            		/// 榨汁杯/电风扇
	            		var random = Math.floor(Math.random()*(2-1+1)+1);
	            		if(random == 1){
	            			var pri_1 = '榨汁杯一个';
	            		}else if(random == 2){
	            			var pri_1 = '迷你电风扇一台';
	            		}
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}

	            	if(res == 4){
	            		// 红包6.6
	            		var pri_1 = '红包6.6元';
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}
	            	if(res == 5){
	            		// 红包2.88
	            		var pri_1 = '红包2.88元';
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}
	            	if(res == 6){
	            		// 红包1.68
	            		var pri_1 = '红包1.68元';
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}
	            	if(res == 7){
	            		// 红包1.28
	            		var pri_1 = '红包1.28元';
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}
	            	if(res == 8){
	            		// 红包0.88
	            		var pri_1 = '红包0.88元';
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}

	            	if(res == 9){
	            		// 红包0.68
	            		var pri_1 = '红包0.68元';
	            		
	            		$('.price').find('.p_1').text(pri_1);
	            		$('.price').show();
	            		$('.p_1').show();
	            	}

	            	if(res == 10){
	            		//未中奖
	            		
	            		$('.lost').show();
	            	}

	            	if(res == 11){
	            		// 3次玩完了
	            		$('.price').hide();
	            		alert('您今天的次数用完了，明天再来吧！')
	            		window.location.href = 'http://www.aumantruck.com/mobile/spike_game.php?';
	            	}

	            }
	        });
		})


		function tj(){
			location.reload();
	    }

// 禁止拖动屏幕
        var video1 = document.getElementsByClassName('content')[0];
        var video2 = document.getElementsByClassName('kai')[0];
        var video3 = document.getElementsByClassName('wu')[0];
        var video4 = document.getElementsByClassName('but')[0];
        var video5 = document.getElementsByClassName('gif')[0];
        video1.addEventListener("touchmove",function(event){
            event.preventDefault();
        });
        video2.addEventListener("touchmove",function(event){
            event.preventDefault();
        });
        video3.addEventListener("touchmove",function(event){
            event.preventDefault();
        });

        video4.addEventListener("touchmove",function(event){
            event.preventDefault();
        });
        video5.addEventListener("touchmove",function(event){
            event.preventDefault();
        });
    	document.body.addEventListener('touchmove', function(event) {
    		event.preventDefault();
    	});

       	// 适配华为键盘影响布局的问题
		var h = window.innerHeight;
		var myInput = document.getElementById('names');
		var myInputs = document.getElementById('phone');

		myInput.addEventListener('focus',handler,false);
		myInputs.addEventListener('focus',handlers,false);

		function handler(){
			console.log(h)
			$('body').height(h);
// 　　		$('body').height($('body')[0].clientHeight);

		}

		function handlers(){
			// alert(h)
			$('body').height(h);
// 　　		$('body').height($('body')[0].clientHeight);

		}


		// 音频播放
        function Play(e) {
            var audio = document.getElementsByClassName('audio')[0];

            console.log(audio.paused);

            if(audio.paused){

        	   audio.play();

                console.log('播放')

            }else{

        	   audio.pause();

                console.log('暂停')

            }
        }



        window.onload = function(){

	
			Media = document.getElementById("music");

			Media.src = "templates/game/img/1.mp3"; 

			Media.play();
			// session控制音乐
            if (!sessionStorage.getItem("bgm")) {

                 $("#bgmvideo").append(
                    '<audio src="templates/game/img/1.mp3" autoplay hidden></audio>'
                );

                sessionStorage.setItem("bgm", 1)

            }

		}
		
		// 移动端默认初始化时暂停播放，改为初始化页面时播放
		document.addEventListener('DOMContentLoaded', function () {
		    function audioAutoPlay() {

		        var audio = document.getElementsByClassName('audio')[0];

		            audio.play();

		        document.addEventListener("WeixinJSBridgeReady", function () {

		            audio.play();

		        }, false);

		    }

		    audioAutoPlay();
		});


// 错误
        function Play2(e) {
            var audio_1 = document.getElementsByClassName('audio_1')[0];

        	   audio_1.play();


                console.log('播放错误提示')

        }

        // 正确
        function Play3(e) {
            var audio_2 = document.getElementsByClassName('audio_2')[0];

        	   audio_2.play();


                console.log('播放正确提示')

        }
	</script>
</body>
</html>