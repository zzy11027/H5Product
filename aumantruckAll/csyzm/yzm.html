<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<!-- viewport视图宽度设置      视图宽度 = 设备宽度， 初始化视图大小    可调整的最大宽度   可调整的最小宽度   用户是否可以调整视图宽度-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
	<title>合伙赚钱，相荐恨晚！欧曼新营销合伙人荐购大赛</title>
	<link rel="stylesheet" href="/mobile/templates/csyzm/css/reset.css">
	<link rel="stylesheet" href="/mobile/templates/csyzm/css/liuzi.css">

	<script src="/mobile/templates/csyzm/js/jquery.min.js"></script>
    <script src="js/region9.js" type="text/javascript"></script>

    <script src="/mobile/templates/csyzm/js/register_message.js"></script>
	<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?12ebce5ddde1b698958bacdd8cce7342";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


   <script>
        wx.config({
            debug: false, // 开启调试模式调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印�?
            appId: 'wxa1ef57725e6a43a9', // 必填，公众号的唯一标识
            timestamp: '{$arr.timestamp}', // 必填，生成签名的时间
            nonceStr: '{$arr.noncestr}', // 必填，生成签名的随机
            signature: '{$arr.sha1}',// 必填，签名，见附
            jsApiList: [
                "onMenuShareTimeline",
                "scanQRCode",
                "onMenuShareAppMessage",
                "onMenuShareQQ",
                "onMenuShareWeibo",
                "onMenuShareQZone"
            ] // 必填，需要使用的JS接口列表，所有JS接口列表见附
        });
        wx.ready(function () {
            wx.onMenuShareAppMessage({
                title: '合伙赚钱，相荐恨晚！欧曼新营销合伙人荐购大赛', // 分享标题
                desc: '月赚十万，就等你来！', // 分享描述
                link: 'http://www.aumantruck.com/spike_csyzm.php', // 分享链接
                imgUrl: 'http://www.aumantruck.com/mobile/templates/csyzm/img/logo.jpg', // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    //alert("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    //alert("取消成功");
                    // 用户取消分享后执行的回调函数
                }

            });
            wx.onMenuShareTimeline({
                title: '合伙赚钱，相荐恨晚！欧曼新营销合伙人荐购大赛', // 分享标题
                link: 'http://www.aumantruck.com/spike_csyzm.php', // 分享链接
                imgUrl: 'http://www.aumantruck.com/mobile/templates/csyzm/img/logo.jpg', // 分享图标
                success: function () {
                  //  alert("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                  //  alert("取消成功");
                    // 用户取消分享后执行的回调函数
                }
            });
        })
    </script>
</head>
<body>
	
	<div class="nav">
		<a href="spike_csyzm.php?step=test"></a>
		<div class="but-1"></div>
		<form method="post" action="spike_csyzm.php?step=gezx" id="myForm">
	        	<input type="hidden" name="openid" value="{$openid}">
		<a onclick="formSubmit();" class="a-2"></a>
		</form>
	</div>

	<div class="guize" style="display: none">
		
	</div>
	

	<div id="input-1">
		<input type="hidden" id="openid" value="{$openid}" />
		<input type="text" class="input-1" id="tjrname" placeholder="" value="推荐人姓名" onfocus="if(value=='推荐人姓名') {value=''}" onblur="if (value=='') {value='推荐人姓名'}">
		<input type="text" class="input-2" id="tjrtel" placeholder="" value="推荐人电话" onfocus="if(value=='推荐人电话') {value=''}" onblur="if (value=='') {value='推荐人电话'}">
		<input type="text" class="input-3" id="captcha"  name="captcha" placeholder=""  value="请输入验证码" onfocus="if(value=='请输入验证码') {value=''}" onblur="if (value=='') {value='请输入验证码'}">
		<div id="get_pic_yzm"><img class="tpyz" src="captcha.php?{$rand}" alt="captcha" onClick="this.src='captcha.php?'+Math.random()" width="100%" height="100%" /></div>


		<input type="text" class="input-4"  id="yzm" placeholder="" value="请输入验证码" onfocus="if(value=='请输入验证码') {value=''}" onblur="if (value=='') {value='请输入验证码'}">
		<div id="getYzm" onclick="send_capicha_regist()">获取验证码</div>
		<input type="text" class="input-5" id="sfz" placeholder="" value="{if $data_xx.sfz!=''}{$data_xx.sfz}{else}请输入您的身份证号码{/if}" onfocus="if(value=='请输入您的身份证号码') {value=''}" onblur="if (value=='') {value='请输入您的身份证号码'}">
		<input type="text" class="input-6" id="yh" placeholder="" value="{if $data_xx.yh!=''}{$data_xx.yh}{else}请输入您的银行{/if}" onfocus="if(value=='请输入您的银行') {value=''}" onblur="if (value=='') {value='请输入您的银行'}">
		<input type="text" class="input-7" id="yhkh" placeholder="" value="{if $data_xx.yhkh!=''}{$data_xx.yhkh}{else}请输入您的银行卡号码{/if}" onfocus="if(value=='请输入您的银行卡号码') {value=''}" onblur="if (value=='') {value='请输入您的银行卡号码'}">
		<input type="text" class="input-8" id="gcname" placeholder="" value="请输入购车人的姓名" onfocus="if(value=='请输入购车人的姓名') {value=''}" onblur="if (value=='') {value='请输入购车人的姓名'}">
		<input type="text" class="input-9" id="gctel" placeholder="" value="请输入购车人的电话" onfocus="if(value=='请输入购车人的电话') {value=''}" onblur="if (value=='') {value='请输入购车人的电话'}">

		 <select class="input-10" id="selProvinces_1" onchange="region.changed(this, 2, 'selCities_1')" name='apply_field3_1'>
	         <option value="">省</option>
	        <!-- {foreach from=$city_list item=country} -->
	        <option value="{$country.region_id}" <!-- {if $country.region_id eq $fieldData.agency_province}selected{/if}-->{$country.region_name}</option>
         <!-- {/foreach} -->
    	</select>
    	<select  class="input-11" id="selCities_1" onchange="getDistributors(1);" name="apply_field4_1">
	        <option value="">城市</option>
	        <!-- {foreach from=$fieldData.citys item=city} -->
	        <option value="{$city.region_id}" <!-- {if $city.region_id eq $fieldData.agency_city}selected{/if}-->>{$city.region_name}</option>
        <!-- {/foreach} -->
    	</select>
    	<select class="input-12" name="input-12" id="input-12">
			<option value="0">意向车型</option>
			<option value="1">欧曼EST-A</option>
			<option value="2">欧曼EST</option>
			<option value="3">欧曼GTL</option>
			<option value="4">欧曼ETX</option>

    	</select>
	</div>
	
	<button class="but-2">
		
	</button>

	<form method="post" action="spike_csyzm.php?step=gezx" id="myForms">
	       <input type="hidden" name="openid" value="{$openid}">
		<a onclick="formSubmits();" class="success" style="display: none" ></a>
		</form>
	<script type="text/javascript">
		
		//通过比例计算不同设备的根元素的字体大小

		//1.定义参照设备的宽度
		var w = 375;

		//2.定义参照设备的默认根元素的字体大小
		var f = 16;

		//3.获取打开该文件的设备的视图宽度
		var c = document.documentElement.clientWidth;
		console.log(c)
		//4.进行不同设备根元素字体大小的计算
		var nf = c * f / w;
		console.log(nf)

		//5.设置打开该文件的设备的根元素的字体大小即可
		document.documentElement.style.fontSize = nf + 'px';

		$('.but-1').click(function(){
			$('.guize').fadeIn();
		})
		$('.guize').click(function(){
			$('.guize').fadeOut();
		})
		var a=0;
		$('.but-2').click(function(){
			if(a==0){
			$openid = $("#openid").val();
			//alert($openid);
			$tjrname = $("#tjrname").val();
			$tjrtel = $("#tjrtel").val();
			$captcha = $("#captcha").val();
			$yzm = $("#yzm").val();
			$sfz = $("#sfz").val();
			$yh = $("#yh").val();
			$yhkh = $("#yhkh").val();
			$gcname = $("#gcname").val();
			$gctel = $("#gctel").val();
			$yzm = $("#yzm").val();
			$province = $("#selProvinces_1").find("option:selected").text();
        	$city = $("#selCities_1").find("option:selected").text();
        	$yxcx = $("#input-12").find("option:selected").text();
			if (!$tjrname) {
	            alert('请输入推荐人姓名');
	            return false;
	        }
	        if ($tjrname == "推荐人姓名") {
	            alert('请输入推荐人姓名');
	            return false;
	        }
	        if ($captcha == "请输入验证码") {
	            alert('请输入图片验证码');
	            return false;
	        }
	        if ($yzm == "请输入验证码") {
	            alert('请输入验证码');
	            return false;
	        }
	        if ($tjrtel == "推荐人电话") {
	            alert('请输入推荐人手机号');
	            return false;
	        }
	        if ($tjrtel == "推荐人电话") {
	            alert('请输入推荐人手机号');
	            return false;
	        }
	        var sfzyz =/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|[xX])$/;
	        var reg = /^0?1[3|4|5|7|8][0-9]\d{8}$/;
	        if (!reg.test($tjrtel)) {
	            alert("请输入正确的推荐人手机号");
	            return false;
	        }
	        if (!$sfz) {
	            alert('请输入您的身份证号码');
	            return false;
	        }

	        if ($sfz == "请输入您的身份证号码") {
	            alert('请输入您的身份证号码');
	            return false;
	        }
	        if (!sfzyz.test($sfz)) {
	            alert("身份证格式不正确");
	            return false;
	        }
	        if (!$yh) {
	            alert('请输入您的银行');
	            return false;
	        }
	        if ($yh =="请输入您的银行") {
	            alert('请输入您的银行');
	            return false;
	        }
	        if (!$yhkh) {
	            alert('请输入您的银行卡号码');
	            return false;
	        }
	        if ($yhkh =="请输入您的银行卡号码") {
	            alert('请输入您的银行卡号码');
	            return false;
	        }
	        if (!$gcname) {
	            alert('请输入购车人的姓名');
	            return false;
	        }
	        if ($gcname =="请输入购车人的姓名") {
	            alert('请输入购车人的姓名');
	            return false;
	        }
	        if (!$gctel) {
	            alert('请输入购车人的电话');
	            return false;
	        }
	        if ($gctel =="请输入购车人的电话") {
	            alert('请输入购车人的电话');
	            return false;
	        }
	        var reg = /^0?1[3|4|5|7|8][0-9]\d{8}$/;
	        if (!reg.test($gctel)) {
	            alert("请输入正确的购车人手机号");
	            return false;
	        }
	        if($yzm==''){
               alert("请输入验证码");
              return false;
        	}
	        if($("select[name='apply_field3_1']").val() == ''){
	            alert("请选择省份");
	            return false;
	        }
	        if (!$("select[name='apply_field4_1']").val()) {
	            alert('请选择市');
	            return false;
	        }
	        if ($("select[name='input-12']").val() == 0) {
	            alert('请选择车型');
	            return false;
	        }
			if (capicha_time()) {
				
					$.ajax({
		            type: 'POST',
		            dataType:'text',
		            url : 'spike_csyzm.php?step=tjcl',
		             data: {
		                    "tjrname":$tjrname,
		                    "tjrtel":$tjrtel,
		                    "sfz":$sfz,
		                    "yh":$yh,
		                    "openid":$openid,
		                    "yhkh":$yhkh,
		                    "gcname":$gcname,
		                    "gctel":$gctel,
		                    "province":$province,
		                    "city":$city,
		                    "yxcx":$yxcx
		                    },
		            success: function(data){
		            	if (data==1) {
		            		$('.success').fadeIn();
		            	}
		            	if (data==9) {
		            		alert("购车人已经推荐过了！");
		            		window.location.href = 'spike_csyzm.php?step=gezx&openid='+$openid;
		            	}
		     
		            }
		        });
					
			} else if (!capicha_time()||$("#yzm").val()=='') {
	             alert('验证码不正确');
	             return false;
	         }
	        }else{
	        	alert('正在提交！')
	        }
	        a=1; 	
			//$('.success').fadeIn();
		})

		$('.success').click(function(){
			$('.success').fadeOut();
		})

		 function formSubmits(){
 			
            $("#myForms").submit();
        
    	}

    	 function formSubmit(){
 			
            $("#myForm").submit();
        
    	}

		function getDistributors(goods_id){
		    if(goods_id == 1){
		        var prov_obj = document.getElementById("selProvinces_1");
		        var prov = prov_obj.options[prov_obj.options.selectedIndex].value;
		        var city_obj = document.getElementById("selCities_1");
		        var city = city_obj.options[city_obj.options.selectedIndex].value;
		    }
		}


	</script>
</body>
</html>